package converter

import (
	"encoding/hex"
	"testing"
)

func TestConvert2OtelSpan(t *testing.T) {
	data := "0ae2030a08291e31f2045a440f1a08291e31f2045a440f20022a0668747470696e319f4015f7abc9050038a9cbf81c42150a0d636f6e666967736572766963651204ac129b744a160a0a676174657761796d67721204ac12920b20908b025a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a300a09687474702e7061746812232f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e5acf010a0375726c12c701687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e3f725f693d63346634383534302d373063372d343231352d383334302d6631626265383165613362662e572e343431363326725f653d676174657761796d677226582d42332d547261636549643d3239316533316632303435613434306626582d42332d5370616e49643d3239316533316632303435613434306626582d42332d53616d706c65643d3168010ae6030a089f9e57890c94c88b1a089f9e57890c94c88b20022a0668747470696e319f4015f7abc9050038d8cbf81c42150a0d636f6e666967736572766963651204ac129b744a180a0c6469706c6f6d6163796d67721204ac12924a20f0c1035a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a300a09687474702e7061746812232f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e5ad1010a0375726c12c901687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e3f725f693d37316239376165352d633030322d343639662d386664632d3237333365646238333633362e572e353733363726725f653d6469706c6f6d6163796d677226582d42332d547261636549643d3966396535373839306339346338386226582d42332d5370616e49643d3966396535373839306339346338386226582d42332d53616d706c65643d3168010adf030a082cc2e663168b28f41a082cc2e663168b28f420022a0668747470696e31104a15f7abc90500389ebff81c42150a0d636f6e666967736572766963651204ac129b744a150a0966756e64636f7265661204ac12913320c681025a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a300a09687474702e7061746812232f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e5acd010a0375726c12c501687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e3f725f693d36666537383862322d613463302d343939312d383330662d3262336437343230336532312e572e3838343526725f653d66756e64636f72656626582d42332d547261636549643d3263633265363633313638623238663426582d42332d5370616e49643d3263633265363633313638623238663426582d42332d53616d706c65643d3168010ade030a08fb20c7b7d5f2637c1a08fb20c7b7d5f2637c20022a0668747470696e310fc01ff7abc9050038c8cfce1c42150a0d636f6e666967736572766963651204ac129b744a180a0c63616d706169676e636f6e661204ac1290ed20c8db025a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a2d0a09687474702e7061746812202f636f6e666967736572766963652f646963742f6e6f74696669636174696f6e5acc010a0375726c12c401687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f646963742f6e6f74696669636174696f6e3f725f693d65393964646539652d353138652d343838332d393636342d3435326330653465323030312e572e33363426725f653d63616d706169676e636f6e6626582d42332d547261636549643d6662323063376237643566323633376326582d42332d5370616e49643d6662323063376237643566323633376326582d42332d53616d706c65643d3168010ae8030a08af6ca4d62905e8d01a08af6ca4d62905e8d020022a0668747470696e319f4015f7abc905003882cdf81c42150a0d636f6e666967736572766963651204ac129b744a190a0d72657665727365656e67696e651204ac12901620b2ba025a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a300a09687474702e7061746812232f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e5ad2010a0375726c12ca01687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e3f725f693d32616533396237302d653337332d343062352d626564362d3965666337643662626535652e572e323838393926725f653d72657665727365656e67696e6526582d42332d547261636549643d6166366361346436323930356538643026582d42332d5370616e49643d6166366361346436323930356538643026582d42332d53616d706c65643d3168010ada030a08c4d6a61e6f45631e1a08c4d6a61e6f45631e20022a0668747470696e311dc01ff7abc9050038e4e3ce1c42150a0d636f6e666967736572766963651204ac129b744a130a077061796d656e741204ac12924f20f6d4035a480a036170691241636f6e666967736572766963652e41627374726163744e6f74696669636174696f6e436f6e74726f6c6c65722e706f6c6c4e6f74696669636174696f6e282e2e295a200a056572726f72121754696d6564206f75742061667465722036303030306d735a130a0b687474702e6d6574686f641204504f53545a300a09687474702e7061746812232f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e5aca010a0375726c12c201687474703a2f2f3137322e31382e3135352e3131363a383038302f636f6e666967736572766963652f737973636f6e662f6e6f74696669636174696f6e3f725f693d63353763363565302d363839382d343631312d383035342d3930316665326239313266302e572e33323726725f653d7061796d656e7426582d42332d547261636549643d6334643661363165366634353633316526582d42332d5370616e49643d6334643661363165366634353633316526582d42332d53616d706c65643d316801"
	dataArray, _ := hex.DecodeString(data)

	zSpans, _ := ParseSpans(dataArray, false)

	if d1, err := Convert2OtelSpan(zSpans); err != nil {
		t.Errorf("Convert Failed. %v", err)
	} else {
		if len(d1) != 1 {
			t.Errorf("Trace Size: Expected 1, Acutal: %d", len(d1))
		}
	}
}
